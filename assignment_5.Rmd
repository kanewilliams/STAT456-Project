---
title: "Assignment 5 - Decomposing New Zealand wholesale electricity prices using stl() and str()"
author:
  - name: Kane Williams (pkw21@uclive.ac.nz)
link-citations: true
subtitle: STAT456-24S2 - Time Series and Stochastic Processes
header-includes:
   - \usepackage{amsmath}
output:
  html_document:
    toc: true
    toc_float: true
    highlight: tango
    theme: flatly
editor_options:
  markdown:
    wrap: 72
---

```{=html}
<style>

.boxTask {
background-color: lightblue;
color: black;
border: 2px solid black;
margin: 5px;
padding: 5px;
font-style: italic;
}

/* Centered headings */
h1, h2, h3, h4, h5, h6 {
  text-align: center;
}

</style>
```


```{r echo=FALSE}
source("./src/packages.R")
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 80), tidy = TRUE)
```

```{=html}
<style>

.boxTask {
background-color: lightblue;
color: black;
border: 2px solid black;
margin: 5px;
padding: 5px;
font-style: italic;
}

/* Centered headings */
h1, h2, h3, h4, h5, h6 {
  text-align: center;
}

</style>
```

In this assignment/project, New Zealand's wholesale electricity prices will be decomposed using two different methods. The results and the residuals will be compared.

# Introduction

## New Zealand's Wholesale electricity market

New Zealand's electricity market was liberalised in BLA BLA.

## Introduction to stl() and str()

stl() is an R package that allows decomposing a time series into two components.

str() is a recent R package by ...

::: boxTask
Bla bla ba
:::

# Data Import

The dataset chosen was: **Wholesale price trends**.

-   It was pulled from the [Electricity Authority](https://www.emi.ea.govt.nz/Wholesale/Reports/W_P_C?DateFrom=20140101&DateTo=20240101&RegionType=NZ&TimeScale=DAY&_si=_dr_DateFrom|20140101,_dr_DateTo|20240101,_dr_RegionType|NZ,_dr_TimeScale|TP,v|4) with the
    following parameters:
    -   **Date Range**: 01 Jan 2014 - 01 Jan 2024
    -   **Region Type**: New Zealand
    -   **Time Scale** Trading Period (i.e. half-hourly data)

```{r}
# READ DATA
file_path <- "./data/NZ_Wholesale_Electricity_Prices_2014-2024.csv"
header <- c("Period_Start", "Period_End", "Region_ID", "Region", "Price")

csv_data <- read_csv(file_path, 
                     skip = 12, 
                     col_names = header,
                     show_col_types = FALSE) %>%
  mutate(
    Price = as.numeric(Price),
    Period_Start = dmy_hms(Period_Start),
    Period_End = dmy_hms(Period_End)
  )

head(csv_data, 3)
```


```{r}
# CREATE ts OBJECT
frequency <- 2 * 24 * 365.25  # Half-hourly data for a year

elec_ts <- ts(csv_data$Price, 
                     start = c(2014, 1), 
                     end = c(2024, 1),
                     frequency = frequency)

# Print first few rows to verify
print(head(elec_ts))
```


# Decomposition using stl()

```{r}
# TODO: stl
```


It was found that ...

# Decomposition using str()

Bla bla bla...